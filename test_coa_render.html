<!DOCTYPE html>
<html>
<head>
    <title>COA Direct Test</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        #container { display: flex; gap: 20px; }
        #left { flex: 1; }
        #right { flex: 2; border: 1px solid #ccc; padding: 10px; height: 600px; overflow: auto; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 5px; max-height: 300px; overflow: auto; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>

<h1>COA Direct Test</h1>

<div id="container">
    <div id="left">
        <h3>Response Info</h3>
        <pre id="info"></pre>
        <button onclick="testEndpoint()">Test Endpoint</button>
    </div>
    <div id="right">
        <h3>HTML Preview</h3>
        <div id="preview"></div>
    </div>
</div>

<script>
function testEndpoint() {
    const info = document.getElementById('info');
    info.textContent = 'Loading...';
    
    fetch('/faculty/ajax/generate_coa_html.php?class_code=24_T2_CCPRGG1L_INF222')
        .then(r => r.json())
        .then(data => {
            if (data.success) {
                info.textContent = `✓ Success\nHTML Length: ${data.html.length} bytes\nClass: ${data.class_code}`;
                
                // Display in div
                document.getElementById('preview').innerHTML = data.html;
                
                // Also in iframe for comparison
                const iframe = document.createElement('iframe');
                iframe.srcDoc = data.html;
                iframe.style.cssText = 'width:100%; height:100%; border:1px solid red;';
                document.getElementById('right').appendChild(iframe);
                
            } else {
                info.textContent = `✗ Error: ${data.message}`;
            }
        })
        .catch(err => {
            info.textContent = `✗ Fetch Error:\n${err.message}`;
        });
}

// Auto test on load
window.addEventListener('load', testEndpoint);
</script>

</body>
</html>
